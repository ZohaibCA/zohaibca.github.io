<!DOCTYPE HTML>
<!--
	Zohaib Aftab, Data Scientist
	zohaibdr.github.io | 
	To showcase my projects
-->
<html  lang="en">
	<head>

		<meta charset="utf-8">
		<meta content="width=device-width, initial-scale=1.0" name="viewport">
	  
		<title>Project: Gearbox diagnosis </title>

		<meta content="" name="description">
		<meta content="" name="keywords">
	  
		<!-- Favicons -->
		<link href="assets/img/favicon.png" rel="icon">
		<link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">
	  
		<!-- Vendor CSS Files -->
		<link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
		<link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
		<link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
		<link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
	  
		<!-- Template Main CSS File -->
		<link href="assets/css/style.css" rel="stylesheet">

		<!-- Add icon library, For the download button --> 
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<style> <!--For the download button-->
		.btn {
		  background-color: DodgerBlue;
		  border: none;
		  color: white;
		  padding: 12px 30px;
		  cursor: pointer;
		  font-size: 20px;
		} 
		/* Darker background on mouse-over */
		.btn:hover {
		  background-color: RoyalBlue;
		}
		</style>


		<style>
			img{
				max-width: 90%;  
				display: block; /* remove extra space below image */
			}
		</style>

	</head>
	
	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-TSB82NSVFW"></script>
	<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());

	gtag('config', 'G-TSB82NSVFW');
	</script>

	
	<body>

		<!-- ======= Header ======= -->
		<header id="header" class="fixed-top">
		  <div class="container d-flex align-items-center justify-content-between">
	  
			<!-- <h1 class="logo"><a href="index.html">DevFolio</a></h1> -->
			<!-- Uncomment below if you prefer to use an image logo -->
			<a href="index.html" class="logo"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>
	  
	  
			<nav id="navbar" class="navbar">
				<ul>
				  <li><a class="nav-link scrollto active" href="index.html">Home</a></li>
				  <li><a class="nav-link scrollto" href="index.html#about">About</a></li>
				  <!-- <li><a class="nav-link scrollto" href="index.html#services">Services</a></li> -->
				  <li><a class="nav-link scrollto " href="index.html#portfolio">Portfolio</a></li>
				  <!-- <li><a class="nav-link scrollto " href="index.html#blog">Blog</a></li> -->
				  
				  <li><a class="nav-link scrollto" href="index.html#contact">Contact</a></li>
				</ul>
				<i class="bi bi-list mobile-nav-toggle"></i>
			  </nav><!-- .navbar -->
	  
	  
			<!-- .navbar -->
	  
		  </div>
		</header><!-- End Header -->
	  
		<div class="hero hero-single route bg-image" style="background-image: url(assets/img/overlay-bg.jpg)">
		  <div class="overlay-mf"></div>
		  <div class="hero-content display-table">
			<div class="table-cell">
			  <div class="container">
				<h2 class="hero-title mb-4">
					AI-powered gearbox fault diagnosis
					</h2>
				<ol class="breadcrumb d-flex justify-content-center">
				  <li class="breadcrumb-item">
					<a href="index.html#Portfolio">Portfolio</a>
				  </li>
				  <li class="breadcrumb-item active">
					AI-powered gearbox fault diagnosis
					</li>
				</ol>
			  </div>
			</div>
		  </div>
		</div>
	  
		<main id="main">
	  
		  <!-- ======= Portfolio Details Section ======= -->
		  <section id="portfolio-details" class="portfolio-details">
			<div class="container">
	  
			  <div class="row gy-4">
	  
				<div class="col-lg-8">
				  <div class="portfolio-details-slider swiper">
					<div class="swiper-wrapper align-items-center">
	  
					  <div class="swiper-slide">
						<img src="images/gear.jpg" alt="">
					  </div>
	  
					  <div class="swiper-slide">
						<img src="images/gearbox/final_data.png" alt="">
					  </div>
	  
					  <div class="swiper-slide">
						<img src="images/gearbox/confusion_labels.png" alt="">
					  </div>
	  
					</div>
					<div class="swiper-pagination"></div>
				  </div>
				</div>
	  
				<div class="col-lg-4">
				  <div class="portfolio-info">
					<h3>Project information</h3>
					<ul>
						<li><strong>Category</strong>: Engineering </li>
						<li><strong>Tags</strong>: Vibration data, AutoML, Health Monitoring  </li>
						<li><strong>Link to dataset </strong>:<a href="https://data.openei.org/submissions/623" target="_blank">  <em> Click here </em> </a> </li>
		
						<p class="pt-3"><a class="btn btn-primary btn js-scroll px-4" href="https://github.com/zohaibdr/Portfolio/tree/master/Gear%20condition" target="_blank" role="button">  See Code on Github  </a></p> 
		
					  </ul>
				  </div>
				  <div class="portfolio-description">
				   
				  </div>
				</div>


					<h2> Context </h2>
					<p>Gearbox fault diagnosis using vibration data is a process of analyzing the vibration signals produced by the gearbox during its operation to identify any faults or abnormalities in the system. In general, healthy gearboxes produce a predictable and stable vibration pattern, while faulty gearboxes produce irregular or abnormal vibration patterns. By analyzing the vibration signals, it is possible to identify various types of faults in the gearbox, such as gear wear, tooth breakage, misalignment, and bearing damage.</p>
					<p>Machine learning can be used to predict tooth breakage issues in gearboxes by analyzing the vibration data collected from the gearbox during operation. </p>
					
					<h2> Data and Approach </h2>
					<p>I used a vibration dataset recorded using a diagnostic simulator in healthy and broken tooth conditions. The data is available at National Renewable Energy Laboratory webpage <a href="https://data.openei.org/submissions/623" target="_blank">https://data.openei.org/submissions/623</a>. </p>

					<p> <img src="images/gearbox/simulator.png" alt=""/> </p> 
					
					<p>There are 20 files in total (10 for each condition) containing data from 4 sensors (a1 through a4) for a load ranging from 0% to 90%. Each file contains roughly 50-60 min of data with on average 100,000 observations at 30Hz. 
					When combined all files, there are a total of 2,021,118 observations. In the state column 'b' stands for broken tooth, 'h' stands for healthy. </p>

					<p> <img src="images/gearbox/data.png" alt=""/> </p> 


					<h2> Data Analysis </h2>
					<p>To analyze this dataset, I combined the reading from all four sensors into a single column using <strong>pandas</strong> <code>melt</code> function, tagged with the <code>sensor</code>, <code>load</code> and <code>state</code> of the gearbox. This facilitates plotting of data for each sensor systematically in Python. </p>
					<p>First, I started with visual inspection of sensor readings for healthy and broken gearboxes at different loads. When plotted raw values side by side, the differences were not perceptible with the naked eye. </p>

					<p> <img src="images/gearbox/visual1.png" alt=""/> </p> 
					
					<p>For a more comprehensive visual analysis, I used <strong>seaborn</strong> 'violin' and 'boxen' plots to show the distribution of sensor readings and compare like for like between the healthy and broken gearboxes for the same <code>load</code> and <code>sensor</code>. 
					Each column is a different sensor, each row is increasing load. Each plot shows the distribution of reading values between the 'healthy' and 'broken' gearbox </p>
					
					<p> <img src="images/gearbox/violin.png" alt=""/> </p> 
					
					<p>Apparently, there is a perceptible difference between 'healthy' and 'broken' gearboxes on sensors 'a1'  and 'a2' , especially as the load increases. The differences in sensors 'a3' and 'a4' don't appear to be significant. 

					Finally, I list the overall mean and standard deviation from all four sensors separated by their health. Here, unlike violin plots, I observed a clear difference between healthy and broken signal at sensors 'a1' and 'a3'.</p>
					<p> <img src="images/gearbox/stdTable.png" alt=""/> </p> 
					
					<h2>Data manipulation and feature engineering</h2>
					<p>As observed in the previous section, statistics describing the spread of data may differentiate between gearboxes. In this section, I created the features which will be input to the machine learning model for learning.</p> 

					<p>First, for each unique combination of 'state', 'load', and 'sensor' columns in df_melt, I grouped the corresponding rows using the <code>groupby</code> method. Then, for each group, I split the 'reading' column values into chunks of 500 using <code>numpy.split</code>. For each chunk, I then computed the following statistical measures:</p>
					<ul>
					<li>Mean,</li>
					<li>Standard deviation,</li>
					<li>Kurtosis, and</li>
					<li>Skewness</li>
					</ul>

					<p>Finally, I created a dictionary of these statistics along with the corresponding values of 'load' and 'sensor' columns. The dictionary is appended to a list 'data'. I then assigned <strong>a binary label of 1 if the 'state' column value is 'broken'</strong> and a label of 0 otherwise.</p>

					<p> <img src="images/gearbox/final_data.png" /> </p>

					<h2>Results</h2>
					<p>I used the <b>TPOT Automated Machine Learning</b> tool to find the best classifier to differentiate the gearboxes. The<b><code>TPOTClassifier</code></b> searches over a broad range of supervised classification algorithms, transformers, and their parameters.</p>

<pre>
<code>
from tpot import TPOTClassifier  
# https://epistasislab.github.io/tpot/using/

tpot_td = TPOTClassifier(generations=5, random_state=42, max_time_mins=20, verbosity=2, cv=3)
tpot_td.fit(X_train, y_train)

print(f'Best accuracy score: {tpot_td.score(X_test, y_test):0.2%}')
tpot.export('tpot_gears_pipeline.py')
</code>
</pre>

					<p>In about 20 minutes, the best pipeline is found as the <b> <code>ExtraTreesClassifier</code> </b> having an accuracy score of ~80% with the included parameters:</p>
<pre> 
<code>
Best pipeline: ExtraTreesClassifier(input_matrix, bootstrap=False, criterion=entropy, 
				max_features=0.45, min_samples_leaf=2, min_samples_split=8, n_estimators=100) 
Best accuracy score: 79.98%
</code>
</pre>

					<p>This is a meta estimator that fits a number of randomized decision trees (a.k.a. extra-trees) on various sub-samples of the dataset and uses averaging to improve the predictive accuracy and control over-fitting. I further calculated the confusion matrix and associated metrics:</p>
					<p> <img src="images/gearbox/confusion_matrix.png" />

					<p>Out of 4836 test examples, the majority of healthy and broken gearboxes (true negatives and true positives respectively) are correctly predicted. At 495 occasions, the model predicted the gearbox to be faulty while it actually fine (false positive). Similarly, the model missed to capture a faulty gearbox at 473 occasions (false negative). </p>

					<p> <img src="images/gearbox/class_report.png" />
					
				
				<p> Overall, the precision, recall and f1-scores of the model were all 80%. </p>

				</div>

			</div>
		  </section>
		  <!-- End Portfolio Details Section -->
	  
	  
		<!-- ======= Footer ======= -->
		<footer>
		  <div class="container">
			<div class="row">
			  <div class="col-sm-12">
				<div class="copyright-box">
				  <p class="copyright">&copy;  All Rights Reserved</p>
				  <div class="credits">
					<!--
					All the links in the footer should remain intact.
					You can delete the links only if you purchased the pro version.
					Licensing information: https://bootstrapmade.com/license/
					Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/buy/?theme=DevFolio
				  -->
					Design credit to <a href="https://bootstrapmade.com/" target="_blank"> BootstrapMade</a>
				  </div>
				</div>
			  </div>
			</div>
		  </div>
		</footer><!-- End  Footer -->
	  
		<div id="preloader"></div>
		<a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
	  
		<!-- Vendor JS Files -->
		<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
		<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
		<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
		<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
		<script src="assets/vendor/typed.js/typed.min.js"></script>
		<script src="assets/vendor/php-email-form/validate.js"></script>
	  
		<!-- Template Main JS File -->
		<script src="assets/js/main.js"></script>
	  
		</body>
	  
	  </html>