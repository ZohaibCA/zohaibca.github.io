<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Zohaib Aftab: Customer Churn Prediction</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- Add icon library, For the download button --> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <style> <!--For the download button-->
  .btn {
    background-color: DodgerBlue;
    border: none;
    color: white;
    padding: 12px 30px;
    cursor: pointer;
    font-size: 20px;
  } 
  /* Darker background on mouse-over */
  .btn:hover {
    background-color: RoyalBlue;
  }
  </style>
</head>



<body>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top">
    <div class="container d-flex align-items-center justify-content-between">

      <!-- <h1 class="logo"><a href="index.html">DevFolio</a></h1> -->
      <!-- Uncomment below if you prefer to use an image logo -->
      <a href="index.html" class="logo"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>


			<nav id="navbar" class="navbar">
			  <ul>
				<li><a class="nav-link scrollto active" href="index.html">Home</a></li>
				<li><a class="nav-link scrollto" href="index.html#about">About</a></li>
				<!-- <li><a class="nav-link scrollto" href="index.html#services">Services</a></li> -->
				<li><a class="nav-link scrollto " href="index.html#portfolio">Portfolio</a></li>
				<!-- <li><a class="nav-link scrollto " href="index.html#blog">Blog</a></li> -->
				
				<li><a class="nav-link scrollto" href="index.html#contact">Contact</a></li>
			  </ul>
			  <i class="bi bi-list mobile-nav-toggle"></i>
			</nav><!-- .navbar -->


      <!-- .navbar -->

    </div>
  </header><!-- End Header -->

  <div class="hero hero-single route bg-image" style="background-image: url(assets/img/overlay-bg.jpg)">
    <div class="overlay-mf"></div>
    <div class="hero-content display-table">
      <div class="table-cell">
        <div class="container">
          <h2 class="hero-title mb-4">Customer Churn Prediction</h2>
          <ol class="breadcrumb d-flex justify-content-center">
            <li class="breadcrumb-item">
              <a href="index.html#work">Portfolio </a>
            </li>
            <li class="breadcrumb-item active">Customer Churn Prediction</li>
          </ol>
        </div>
      </div>
    </div>
  </div>

  <main id="main">

    <!-- ======= Portfolio Details Section ======= -->
    <section id="portfolio-details" class="portfolio-details">
      <div class="container">

        <div class="row gy-4">

          <div class="col-lg-8">
            <div class="portfolio-details-slider swiper">
              <div class="swiper-wrapper align-items-center">

                <div class="swiper-slide">
                  <img src="images/Reason-to-Leave.png" alt="">
                </div>

                <div class="swiper-slide">
                  <img src="images/customer_churn/PRecall.png" alt="">
                </div>

                <div class="swiper-slide">
                  <img src="images/customer_churn/byarea.png" alt="">
                </div>

              </div>
              <div class="swiper-pagination"></div>
            </div>
          </div>

          <div class="col-lg-4">
            <div class="portfolio-info">
              <h3>Project information</h3>
              <ul>
                <li><strong>Category</strong>: Marketing/Sales </li>
                <li><strong>Tags</strong>: Classification, Precision, Recall  </li>
                <li><strong>Link to dataset </strong>:<a href="https://raw.githubusercontent.com/LasalJayawardena/ML-Projects/main/Telecom_Churn_Prediction/telecom_churn.csv" target="_blank">  <em> Click here </em> </a> </li>

                <p class="pt-3"><a class="btn btn-primary btn js-scroll px-4" href="" target="_blank" role="button">  See Code on Github  </a></p> 

              </ul>
            </div>
            <div class="portfolio-description">
             
            </div>
          </div>

          <!-- Detailed report starts here  -->
          <> 

            <h1>Context</h1>
            <p>Predicting churn rate is crucial for these companies because the cost of retaining an existing customer is far less than acquiring a new one. <br/> <strong>Machine learning</strong> helps companies analyze customer churn rate based on several factors such as services subscribed by customers, tenure rate, and the usage. </p>
      <p><strong>The end goal</strong> of this project is to identify customers who are likely to leave a company, so that the company can take proactive steps to retain those customers. </p>

            <h1><strong>Data I used:</strong></h1>
            <ol>
              <li>Customers who left within the last month – the column is called ‘class’</li>
              <li>Services that each customer has signed up for – international plan, voice mail plan, etc.</li>
              <li>Customer account information and usage – how long they’ve been a customer, how much did they use each service</li>
              <li>Their postal code</li>
              <li>And finally, the number of customer service calls they made during this period</li>
            </ol>
            <p>There were a total of 5000 entries in the dataset.</p>
            
            <p> <img src="images/customer_churn/data.png" alt=""></p>
            <h2><strong>Exploratory data analysis</strong></h2>
            <p>During the EDA phase, I mainly asked the following three questions:</p>
            <ol>
              <li>Is the data balanced in terms of both classes (0 for customer who stayed, 1 for who churned)?</li>
      
              <li>How many distinct areas did the customers come from and was there a specific area which showed a pattern?</li>
              <li>Are there any redundant columns which may be removed?</li>
              
            </ol>
            
            <h3>Answer to Q1:</h3>
            <ul>
              <li>Churn data is typically imbalanced where the minority class (the number of customers who churn) is often much smaller than the number of customers who do not churn. Here the class distribution is about 1:7 which is significant but not severe.
              </li>
              
             <p> <img src="images/customer_churn/classes.png" alt="">  </p> 
            
            
              <li> Any random guess would give us the accuracy of about 86% hence <strong>Accuracy would not the right metric to evaluate the model.</strong> 
              Plus I used <strong>stratified sampling</strong> in the <em> 'train_test_split' </em> to have fair distribution of minority class in both subsets of data. 
      
              </li>
            </ul>
            
      
            <h3>Answer to Q2:</h3>
            
            <ul>
              <li>There were 3 unique area codes (415, 408, 510). These were almost equally distributed in both classes. </li>
            <p>  <img src="images/customer_churn/byarea.png" alt="">  </p> 
              </ul>
              
            
              <h3>Answer to Q3:</h3>
            <ul>
              <li> Removed the 'phone_number' column. </li>
              <li> Since total day minutes and charges are highly correlated (more minutes used mean more charge), I removed total minutes column for all categories (day, evening, etc).</li>
            </ul>
            
            
            
          <h2> Models</h2>
          <p> I implemented the following 5 classification algorithms using the sci-kit learn library: </p>
          <ol>
            <li><strong>Logistic Regression</strong></li>
            <li><strong>Support Vector Machine</strong></li>
            <li><strong>K-Nearest Neighbors</strong></li>
            <li><strong>Random Forest Classifier</strong></li>
            <li><strong>Naïve Bayes</strong></li>
          </ol>
          <p>I compared them based on evaluation metrics such as <em>precision</em>, <em>recall</em>, and <em>F1-scores</em>, as well as <em>ROC curve</em> and <em>AUC scores</em>. These results are based on the test set of 1500 values (1280 + 220). The reported values are for positive class, wherever applicable.</p>
      
      
      
          <table style="width:100%; text-align:center; border: 1px solid rgb(0, 0, 0); font-size: 90%;">
              <tr style="background-color: #e0e0ee; font-size: 100%;">
                <th style="text-align:center;">Classifier</th>
                <th style="text-align:center;">Precision (%)</th>
                <th style="text-align:center;">Recall (%)</th>
                <th style="text-align:center;">F1-score (%)</th>
                <th style="text-align:center;">AUC score</th>
              </tr>
              <tr>
                <td>Logistic regression</td>
                <td>60</td>
                <td>19</td>
                <td>28</td>
                <td>0.81</td>
              </tr>
              <tr>
                <td>Support vector machine</td>
                <td>64</td>
                <td>12</td>
                <td>20</td>
                <td>0.80</td>
              </tr>
              <tr style="background-color: #8bf163;">
                <td>Random Forest</td>
                <td>95</td>
                <td>70</td>
                <td>80</td>
                <td>0.91</td>
              </tr>
              <tr>
                <td>K-Nearest Neighbors</td>
                <td>50</td>
                <td>8</td>
                <td>15</td>
                <td>0.56</td>
              </tr>
              <tr>
                <td>Naïve Bayes</td>
                <td>50</td>
                <td>38</td>
                <td>43</td>
                <td>0.85</td>
              </tr>
            </table>
              
          <h2>Best classifier and interpretation of results</h2>
          <p>The Random Forest classifier came out to be the best classifier as evident from the table and the follwoing ROC curve.</p>
          <p> <img src="images/customer_churn/ROC.png"/>  </p>
          <p>For the chosen classifier, the <strong>precision</strong> is 95%. This indicates that out of all the customers that the model predicted to leave, 95% of them actually did. This is good precision. The company can target those customers to retain those customers. </p>
            
          <p> Similarly, of all the customers who did leave, the model predicted the outcome with <b>70%</b> accuracy (<strong>recall</strong>). <strong>This means it is missing out 30% of leavers, which could be a big loss in terms of loss.</strong> 
      </p>
      <blockquote> 			
        We need to improve the recall score for our classifier for which analysis precision-recall tradeoff.</blockquote>
      
      
          <h2>The Precision-Recall tradeoff</h2>
          <p>I plotted the precision-recall graph for the random forest classifier and identified our current point.</p>
        <p>  <img src="images/customer_churn/PRecall.png"/>  </p> 
          <p>Improving recall required sacrificing some precision. I wrote a small function to obtain at least <b>83%</b> recall:</p>
      
      <pre><code># Calculate the recall and precision at DEFAULT setting
      recall = recall_score(y_test, y_pred)
      precision = precision_score(y_test, y_pred)
      # Adjust the threshold to improve the recall 
      desired_recall = 0.82   		#looking at the precision-recall curve, this seems like a good point 
      while recall &lt; desired_recall:
        threshold -= 0.05
        y_pred = (y_prob &gt;= threshold).astype(int)
        recall = recall_score(y_test, y_pred)
        precision = precision_score(y_test, y_pred)
      optim_threshold = threshold
      
      print('At the threshold of %0.2f' %optim_threshold, ', the final recall is : %0.3f' %recall, 'while the precision is: %0.3f' %precision)
      # At the threshold of 0.30 , the final recall is : 0.835 while the precision is: 0.808
      </code></pre>
      
          <p>At the cut-off of <b>0.3</b>, I got a sweet-spot where both precision and recall were above 80%. This was chosen as an acceptable tradeoff.</p>
      
      
          <p>But which features are the best predictors?</p>
          <p>As a last step, I wanted to see which factors contribute the most to the prediction of customer churn. It turned out the <b>total day usage</b> was the top predictor of churn, followed by <b>number of customer service calls</b>.</p>

         <p> <img src="images/customer_churn/FeatureImp.png"/>  </p> 
      

          
        </div>

      </div>
    </section>
    <!-- End Portfolio Details Section -->


  <!-- ======= Footer ======= -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-sm-12">
          <div class="copyright-box">
            <p class="copyright">&copy;  All Rights Reserved</p>
            <div class="credits">
              <!--
              All the links in the footer should remain intact.
              You can delete the links only if you purchased the pro version.
              Licensing information: https://bootstrapmade.com/license/
              Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/buy/?theme=DevFolio
            -->
              Design credit to <a href="https://bootstrapmade.com/" target="_blank"> BootstrapMade</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer><!-- End  Footer -->

  <div id="preloader"></div>
  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/typed.js/typed.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

  </body>

</html>